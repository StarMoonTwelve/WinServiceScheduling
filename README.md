# 定时服务调度器

## 概述

该应用程序是一个基于Windows Forms的定时服务调度器，用于在指定的时间和日期自动重启Windows服务。用户可以添加、删除、保存和读取调度任务，并且可以通过启动或停止调度程序来控制任务的执行。

## 功能

- **任务管理**：
  - 添加新任务，指定服务名称、执行时间以及执行的星期几。
  - 删除已存在的任务。
  - 将任务列表保存到文件，或者从文件中读取任务列表。
  
- **调度控制**：
  - 启动调度程序以按时执行任务。
  - 停止调度程序以暂停任务执行。

- **日志记录**：
  - 记录每个任务的添加、删除、执行状态以及错误信息，并在界面上显示。

## 界面说明

- **任务输入**：
  - `名称（Name）`：任务的名称。
  - `服务名称（Service Name）`：要重启的Windows服务的名称。
  - `时间设置（Hour, Minute, Second）`：指定服务重启的具体时间。
  - `星期几（Day of Week）`：指定服务重启的星期几。

- **按钮功能**：
  - `Add`：添加新任务到任务列表。
  - `Delete`：从任务列表中删除选中的任务。
  - `Save`：保存当前任务列表到 `tasks.txt` 文件中。
  - `Read`：从 `tasks.txt` 文件中读取任务列表。
  - `Start`：启动调度程序开始执行任务。
  - `Stop`：停止调度程序。

- **任务列表**：
  - 显示所有已添加的任务。

- **日志区域**：
  - 显示操作日志和任务执行日志。

## 文件结构

- **MainForm.cs**: 主窗体代码，包含UI控件的初始化和事件处理逻辑。
- **ScheduledTask.cs**: 表示调度任务的类，包含任务执行的时间和服务名称。
- **tasks.txt**: 存储任务信息的文件，每行记录一个任务。

## 运行环境

- .NET Framework 4.x
- Windows 操作系统

## 使用方法

1. 打开应用程序。
2. 在 `Name`、`Service Name`、`Hour`、`Minute`、`Second` 和 `Day of Week` 输入框中输入相应的任务信息。
3. 点击 `Add` 按钮将任务添加到任务列表。
4. 如果需要保存任务列表，点击 `Save` 按钮。
5. 点击 `Start` 按钮启动调度程序。调度程序将根据设定的时间和日期自动重启服务。
6. 日志区域将显示任务执行情况。
7. 如需停止调度程序，点击 `Stop` 按钮。

## 注意事项

- 确保所输入的服务名称在Windows服务中存在且可用。
- 在执行任务前，可以通过 `Read` 按钮从 `tasks.txt` 文件中读取之前保存的任务列表。
- 保存的任务文件 `tasks.txt` 必须与应用程序在同一目录下。

## 许可证

该项目使用 MIT 许可证，详情见 LICENSE 文件。
